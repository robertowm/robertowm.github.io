{"componentChunkName":"component---src-templates-blog-post-template-js","path":"/posts/2019-04-29-circleci-and-gh-pages-how-to-avoid-failed-builds-on-github-pages-branch/","webpackCompilationHash":"bd5d13cb8362c5ea3e1b","result":{"data":{"markdownRemark":{"html":"<p>My latest project was to reimplement my personal webpage with GatsbyJS.  In the end, it was awesome (and deserves a proper post).  Just a quick summary of this project, it relies on NetlifyCMS to manage my page and posts.  All data is stored on GitHub as static files.  In the end, I decided to use CircleCI to implement Continuum Delivery - every time a change happens on the dev branch, it starts a job to build my webpage and push the compiled project to master branch.</p>\n<p>After spending some time configuring CircleCI configuration file, everything was working nicely... expect when things go to the master branch - I started receiving alerts by email related to building failures...</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/f4c982b5500ff296605910cfbfb97f9c/08b37/circleci-ghpages_email.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 60.23993144815767%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAABjklEQVQoz5VT7UrEMBC81/afICiIiqL4LoI/Rc87fAf1sDnt1/XaJE2u7Tiba7F+gQaG3W0yk+3uZuK9h1IKy+UScRwHJGmKJEmIFCn9oiiQMs6yjHG2PcO99XoNrTXatoWssiwxqesaeb5CVVUQXy746/LOwxobILymaTARdWMMrLXBCrSuoHmb5iUBzKRK4o+42u4NvDE3CEraYxjnYLsOpmlhmYkuVkivr2A2G1iet20XoCn0iTcIbrPqP9YO5eIZ2d0N8vkUq4c58ocZ8tnd1jLO7m8ZT1GxvmYk+l2QvyEZ5NNbvOzuQB3tQ50dYXl+jPjyFG+0rxcnUAe7UId7KJ8eYVi7XwVDHcTy1hU7q2uPt6xCVpBgajbNo+s72hG2z27M/y4o4MEkTVBSJC/ZwaYDSxYwXn8SFDt0zUlzxGdd5VzLRsloDPiXoPcOftOwk47kFg3FNxylIEz8W1Cyq5mZ5bA7DrCjrfusBTLIX3k/j03vy9OT5yhQKsJisYCiH/GZRlEU9se8gfsOj2OXEwqMm9cAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Email about failed build on master\"\n        title=\"Email about failed build on master\"\n        src=\"/static/f4c982b5500ff296605910cfbfb97f9c/8ff1e/circleci-ghpages_email.png\"\n        srcset=\"/static/f4c982b5500ff296605910cfbfb97f9c/9ec3c/circleci-ghpages_email.png 200w,\n/static/f4c982b5500ff296605910cfbfb97f9c/c7805/circleci-ghpages_email.png 400w,\n/static/f4c982b5500ff296605910cfbfb97f9c/8ff1e/circleci-ghpages_email.png 800w,\n/static/f4c982b5500ff296605910cfbfb97f9c/08b37/circleci-ghpages_email.png 1167w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>At CircleCI dashboard, more alerts...</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/0cbd2a1bdcc2b988cb2d069a8f58a7bd/0309e/circleci-ghpages_build-failed.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.25%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAACBUlEQVQoz62STWtaURCGz1aoGhBduPM/uDcqSvpjxGZhAkFCdwGDnz+gXRV3bYkhSVvqzoW0y5Z2kyJomg+Nx+u5n96bvJ25fhDabS88zMvMnPfO4Yy4+HCB2Y/vkL8uoSkFOZ1iykgJTdM2GKYJk3Bdd4NHKF3HjOuGAUXnRbFYxP3oCmoqIanAh0zb9hu5gRvZcE7RtCzYVGMcx/HRTQuK8rphQlGPKJfLZKIDeMDjg+ebKDWHRU1srpOx7evlBJwzVnlzNTXrdb/Y39tDb6BweulgZACPZKxbNAVdx6QJDHupLYqmrrCguLBpUvoBa8ciUzJkbZMWpVIJw+ENBoMbyNsx1PVvGOM7eNoM7kwSM3hyCouuM3c9zB13yeJJJDRCdxYQL3Z3Ifs9yM5b3J+f4Pb0Pe6IyVkH47MTjM87VHuHn1++4tO1RHc0JiYbPnO8muDjcIxvEw2iUCjA8Rb4X5/Ypyv3ul1Ujo/RbDZQqVRQr9fRYBoNnybRajapvqLV8vPVahXVWs3v5/P9fh/i5eEhakdHCG9tIZFIIB6Pb4hGo4jFYohEIgiFQhvC4TCCwSACgYDPM9JCCP8nonxwgDevXyGdyeD5zg7y+bxPLpdDhnLpdBrb29tIpVL/wHkmm80imUyi3W7To9Bi87P7a8E7Rq+5Zr1nDO/Z3zytceRF/wMjSdF0eGttYgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Build failed at CircleCI dashboard\"\n        title=\"Build failed at CircleCI dashboard\"\n        src=\"/static/0cbd2a1bdcc2b988cb2d069a8f58a7bd/8ff1e/circleci-ghpages_build-failed.png\"\n        srcset=\"/static/0cbd2a1bdcc2b988cb2d069a8f58a7bd/9ec3c/circleci-ghpages_build-failed.png 200w,\n/static/0cbd2a1bdcc2b988cb2d069a8f58a7bd/c7805/circleci-ghpages_build-failed.png 400w,\n/static/0cbd2a1bdcc2b988cb2d069a8f58a7bd/8ff1e/circleci-ghpages_build-failed.png 800w,\n/static/0cbd2a1bdcc2b988cb2d069a8f58a7bd/6ff5e/circleci-ghpages_build-failed.png 1200w,\n/static/0cbd2a1bdcc2b988cb2d069a8f58a7bd/0309e/circleci-ghpages_build-failed.png 1280w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>After investigating the problem, I found out that its CircleCI configuration file wasn't correct.  I could filter which jobs are applied to each branch, which helped to avoid building unrelated branches. CircleCI configuration already skips master, then it fails because there no configuration to run :sadpanda:</p>\n<p>I found that I could create a job that does nothing, them filter to be applied only to the master branch.  I didn't like this approach, looks hacky to use it.</p>\n<p>After spending some time on CircleCI documentation, I couldn't find a good solution to ignore commits on the master branch.  So I decided to live with the errors and force me to come back to it.</p>\n<p>One month later, I decided to give another try and found documentation about how to skip builds [[ref]](<a href=\"https://circleci.com/docs/2.0/skip-build/\">https://circleci.com/docs/2.0/skip-build/</a>).  In the end, it's pretty simple: just add \"[skip ci]\" or \"[ci skip]\" at the commit message and CircleCI skips that build.</p>\n<p>I'm using gh-pages to commit and push generated website to master branch.  So I just configured to add \"[skip ci]\" on the commit message.</p>\n<p>Now it's a bit better, no more emails and a nice entry on CircleCI about skipping it.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 800px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/54cfc52108febe48eb007a83718673a2/0309e/circleci-ghpages_build-skipped.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 38.59375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABgElEQVQoz22QS0/CUBCF+5sIEEICLGpY6M7EhX9TXfgIiQsXRqNo0Qo1PosU6LuFlj7gOHMbiBoXJzO5d+abMyPJsoxms4lyuYxKpYJqtSpyVqlUQqvVQrvdFjn/8zvXNBoN1Go11Ot1yFsytnd2sLu3D0nXdZimCdu2YVmWiK7rwvM8kf+VqCFZP8T9HvVcXnchqaoKx3EwHA4xHo8FjBun0yniOBaKomiTJ0mCxWKBBUXO+S0IAoSku4c+pF6vJyYYhiFgDNcGGpR7hYZ8bRysHTLcC0MkaYblcoksy5CTMspvlUdImqYhz3PM53OhOIrxpn9g8PqMkVE4Xp/A9/3C0WyGNCuA3MtaAeicX0Dq9/vCekhTZ1TI0IH7CcV5genYYh3PL2D8z7UzchlRZCCvz0OWqxWOTs8KYJqmv4BP9ju6poYR3dQnZ3wGdslwBoS8SZIK4Pqm7PDg+OR/4JWhojO8gW6MYJkWJpOJEK/NAJdqAzoNA/mm3JNTfkjAb4NjMtimfhvkAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Skipped build on CircleCI dashboard\"\n        title=\"Skipped build on CircleCI dashboard\"\n        src=\"/static/54cfc52108febe48eb007a83718673a2/8ff1e/circleci-ghpages_build-skipped.png\"\n        srcset=\"/static/54cfc52108febe48eb007a83718673a2/9ec3c/circleci-ghpages_build-skipped.png 200w,\n/static/54cfc52108febe48eb007a83718673a2/c7805/circleci-ghpages_build-skipped.png 400w,\n/static/54cfc52108febe48eb007a83718673a2/8ff1e/circleci-ghpages_build-skipped.png 800w,\n/static/54cfc52108febe48eb007a83718673a2/6ff5e/circleci-ghpages_build-skipped.png 1200w,\n/static/54cfc52108febe48eb007a83718673a2/0309e/circleci-ghpages_build-skipped.png 1280w\"\n        sizes=\"(max-width: 800px) 100vw, 800px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Still, I think it should be more elegant to do it directly on CircleCI configuration file.</p>","excerpt":"My latest project was to reimplement my personal webpage with GatsbyJS.  In the end, it was awesome (and deserves a proper post).  Just aâ€¦","fields":{"path":"/posts/2019-04-29-circleci-and-gh-pages-how-to-avoid-failed-builds-on-github-pages-branch/"},"frontmatter":{"title":"CircleCI: Avoiding failed builds on GitHub Pages branch","date":"2019-04-29T08:49:36.610Z","tags":["CircleCI","GitHub Pages","gh-pages","CD"]}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"id":"01cda252-a776-5713-a572-afe49163f9d8"}}}